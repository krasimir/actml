(function(global,factory){typeof exports==="object"&&typeof module!=="undefined"?factory(exports,require("@babel/runtime/helpers/classCallCheck"),require("@babel/runtime/helpers/createClass"),require("@babel/runtime/regenerator"),require("@babel/runtime/helpers/asyncToGenerator")):typeof define==="function"&&define.amd?define(["exports","@babel/runtime/helpers/classCallCheck","@babel/runtime/helpers/createClass","@babel/runtime/regenerator","@babel/runtime/helpers/asyncToGenerator"],factory):factory(global.dialectica={},global._classCallCheck,global._createClass,global._regeneratorRuntime,global._asyncToGenerator)})(this,function(exports,_classCallCheck,_createClass,_regeneratorRuntime,_asyncToGenerator){"use strict";_classCallCheck=_classCallCheck&&_classCallCheck.hasOwnProperty("default")?_classCallCheck["default"]:_classCallCheck;_createClass=_createClass&&_createClass.hasOwnProperty("default")?_createClass["default"]:_createClass;_regeneratorRuntime=_regeneratorRuntime&&_regeneratorRuntime.hasOwnProperty("default")?_regeneratorRuntime["default"]:_regeneratorRuntime;_asyncToGenerator=_asyncToGenerator&&_asyncToGenerator.hasOwnProperty("default")?_asyncToGenerator["default"]:_asyncToGenerator;var Word=function(){function Word(func,params,children){_classCallCheck(this,Word);this.func=func;this.params=params;this.children=children;this.__D=true}_createClass(Word,[{key:"say",value:function say(context){if(Word.isItAWord(this.func)){return this.func.mergeParams(this.params).say(context)}return this.contextifyParams(context).func(this.params)}},{key:"mergeParams",value:function mergeParams(params){this.params=Object.assign({},this.params,params);return this}},{key:"contextifyParams",value:function contextifyParams(context){var _this=this;this.params&&Object.keys(this.params).forEach(function(param){if(context[param])_this.params[param]=context[param]});return this}}],[{key:"isItAWord",value:function isItAWord(word){return word&&word.__D===true}}]);return Word}();var Dialect=function(){function Dialect(){_classCallCheck(this,Dialect)}_createClass(Dialect,[{key:"speak",value:function(){var _speak=_asyncToGenerator(_regeneratorRuntime.mark(function _callee2(word){var context,result,process,pointer,self,_args2=arguments;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:context=_args2.length>1&&_args2[1]!==undefined?_args2[1]:{};if(!Word.isItAWord(word)){_context2.next=15;break}_context2.next=4;return word.say(context);case 4:result=_context2.sent;if(word.params&&word.params["exports"]){context[word.params.exports]=result}if(!(word.children&&word.children.length>0)){_context2.next=12;break}process=function(){var _ref=_asyncToGenerator(_regeneratorRuntime.mark(function _callee(w){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return self.speak(w,context);case 2:if(!(++pointer<word.children.length)){_context.next=4;break}return _context.abrupt("return",process(word.children[pointer]));case 4:case"end":return _context.stop()}}},_callee,this)}));return function process(_x2){return _ref.apply(this,arguments)}}();pointer=0;self=this;_context2.next=12;return process(word.children[0]);case 12:return _context2.abrupt("return",context);case 15:throw new Error("Unexpected word! word = "+word);case 16:case"end":return _context2.stop()}}},_callee2,this)}));return function speak(_x){return _speak.apply(this,arguments)}}()},{key:"create",value:function create(func,params){for(var _len=arguments.length,children=new Array(_len>2?_len-2:0),_key=2;_key<_len;_key++){children[_key-2]=arguments[_key]}return new Word(func,params,children)}}]);return Dialect}();var d=new Dialect;var dialect=d.create.bind(d);var speak=d.speak.bind(d);exports.dialect=dialect;exports.speak=speak;Object.defineProperty(exports,"__esModule",{value:true})});